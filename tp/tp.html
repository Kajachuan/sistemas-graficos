<!doctype html>
<meta content="text/html;charset=UTF-8" http-equiv="Content-Type">
<html>
  <head>
    <title>TP Sistemas Gr치ficos</title>
    <style>
      body{ background-color: grey; }
      canvas{ background-color: white; }
      textarea{ background-color: black; foreground-color: white; }
    </style>

    <script type="text/javascript" src="js/gl-matrix.js"></script>
    <script type="text/javascript" src="js/dat.gui.min.js"></script>
    <script type="text/javascript" src="camera/CameraHandler.js"></script>
    <script type="text/javascript" src="menu/menu.js"></script>


    <script id="shader-vs" type="x-shader/x-vertex">
      attribute vec3 VertexPosition;
      attribute vec3 VertexNormal;
      attribute vec2 VertexTexCoord;

      uniform mat4 ModelMatrix;
      uniform mat4 ViewMatrix;
      uniform mat4 ProjectionMatrix;
      uniform mat3 NormalMatrix;

      struct LightInfo {
        vec4 LightPosition;
        vec3 Intensity;
      };
      uniform LightInfo Light;

      struct MaterialInfo{
        vec3 Ka;
        vec3 Kd;
        vec3 Ks;
        float Glossiness;
      };
      uniform MaterialInfo Material;

      varying vec2 TexCoord;
      varying vec3 ambAndDiff;
      varying vec3 specular;

      void main(void) {
        TexCoord = VertexTexCoord;
        vec3 transformedNormal = normalize(NormalMatrix * VertexNormal);
        vec4 eyeCoords = ViewMatrix * ModelMatrix * vec4(VertexPosition, 1.0);
        vec3 l = normalize(vec3(Light.LightPosition - eyeCoords));
        vec3 v = normalize(-eyeCoords.xyz);
        vec3 r = reflect(-l, transformedNormal);
        vec3 ambient = Light.Intensity * Material.Ka;
        float lambertian = max(dot(l, transformedNormal), 0.0);
        vec3 diffuse = Light.Intensity * Material.Kd * lambertian;
        specular = vec3(0.0);

        if(lambertian > 0.0)
          specular = Light.Intensity * Material.Ks * pow(max(dot(r, v), 0.0), Material.Glossiness);

        ambAndDiff = ambient + diffuse;
        gl_Position = ProjectionMatrix * eyeCoords;
      }
    </script>

    <script id="shader-fs" type="x-shader/x-fragment">
      precision mediump float;

      uniform bool UseTexture;
      uniform sampler2D Sampler;

      varying vec2 TexCoord;
      varying vec3 ambAndDiff;
      varying vec3 specular;

      void main(void) {
        vec4 texColor = vec4(1.0);

        if(UseTexture)
          texColor = texture2D(Sampler, TexCoord);

        gl_FragColor = vec4(ambAndDiff, 1.0) * texColor + vec4(specular, 1.0);
      }
    </script>

    <script type="text/javascript" src="script.js"></script>
  </head>
  <body onload="initWebGL()" id="my-body">
    <center>
      <h1>Trabajo Pr치ctico - Sistemas Gr치ficos</h1>
      <h2>Kevin Cajachu치n - 98.725 | Fabrizio Cozza - 97.402</h2>
      <canvas id="my-canvas" width="900" height="500">
        Your browser does not support the HTML5 canvas element.
      </scanvas>
    </center>
  </body>
</html>
